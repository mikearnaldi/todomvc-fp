(this["webpackJsonptodomvc-fp"]=this["webpackJsonptodomvc-fp"]||[]).push([[0],{110:function(t,n,e){t.exports=e(141)},111:function(t,n,e){},115:function(t,n){},117:function(t,n){},141:function(t,n,e){"use strict";e.r(n);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));e(111);var c,r,a,i,o,u,f,p=e(1),s=e(46),b=e(7),l=e(34),d=e(9),O=e(12),j=e(28),m=e(11),h=e(21),v=e(24),E=e(10),y=e(29),g=e(30),w=e(31),k=e(16),L="@uri/emitter",x=function(t,n){return function(e){return p.f.fromSource(p.c.managed.chain(p.c.bracket(p.a.accessM((function(c){return p.a.sync((function(){var r=p.f.su.queueUtils(),a=r.next,i=r.ops,o=r.hasCB;return{unsubscribe:(e?c[L].addEventListener(e):c[L].fromEvent)(t)((function(t){return a({_tag:"offer",a:t}),n})),ops:i,hasCB:o}}))})),(function(t){return t.unsubscribe})),(function(t){var n=t.ops,e=t.hasCB;return p.f.su.emitter(n,e)})))}},M=Object(k.a)({},"@uri/document",document),N=p.a.provide(M),z=p.a.accessM(Object(m.flow)((function(t){return t["@uri/document"]}),p.a.pure)),A=Object(k.a)({},"@uri/dom",{createElement:function(t,n){return document.createElement(t,n)}}),P=p.a.provide(A),T=function(t){Object(y.a)(e,t);var n=Object(g.a)(e);function e(t){var c;return Object(E.a)(this,e),(c=n.call(this,"$(".concat(t,") did not return an element."))).name="ElementNotFound",c}return e}(Object(w.a)(Error)),B=function(t){Object(y.a)(e,t);var n=Object(g.a)(e);function e(t){var c;return Object(E.a)(this,e),(c=n.call(this,"Parent of node: ".concat(t," not found."))).name="ParentElementNotFound",c}return e}(Object(w.a)(Error)),F=function(t){return new T(t)},C=(Object(m.flow)(F,p.a.raiseError),function(t){return new B(t.toString())}),S=(Object(m.flow)(C,p.a.raiseError),function(t){return function(n){return O.fromNullable(n.querySelector(t))}}),q=function(t){return Object(b.pipe)(z,p.a.map(S(t)),p.a.chain(p.a.fromOption(Object(m.constant)(F(t)))))},D=function(t){return O.fromNullable(t.parentElement)},H=function(t){Object(y.a)(e,t);var n=Object(g.a)(e);function e(t){var c;return Object(E.a)(this,e),(c=n.call(this,t)).name="EmptyOptionOfElement",c}return e}(Object(w.a)(Error)),U=(c="click",e(47)),J=Object(k.a)({},"@uri/fetch",{fetch:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return new Promise((function(t){setTimeout((function(){t(window.fetch.bind(window).apply(void 0,n))}),2e3)}))}}),R=p.a.provide(J),W=function(t){Object(y.a)(e,t);var n=Object(g.a)(e);function e(t){var c;return Object(E.a)(this,e),(c=n.call(this,"Unable to fetch: ".concat(t))).name="FetchFailed",c}return e}(Object(w.a)(Error)),$=function(t){return function(t){return new W("Fetching data from ")}},I=e(103),Q=h.e({id:h.c,userId:h.c,title:h.d,completed:h.b},"Todo"),V=h.a(Q),Z=Object(b.pipe)((r="https://jsonplaceholder.typicode.com/todos",p.a.accessM((function(t){return p.a.async((function(n){try{t["@uri/fetch"].fetch(r,a).then((function(t){return t.json()})).then(Object(m.flow)(U.right,n))}catch(e){n(U.left($("string"===typeof r||r.url)(e)))}return function(t){t($("string"===typeof r||r.url)(""))}}))}))),p.a.chain((function(t){return p.a.sync((function(){return V.decode(t)}))})),p.a.chain(p.a.fromEither)),_=(i="div",p.a.accessM((function(t){return p.a.pure(t["@uri/dom"].createElement(i,o))}))),G=Object(b.pipe)(p.d.unboundedQueue(),p.a.zip(p.e.makeRef(u?[u]:[])),p.a.chain((function(t){var n=Object(d.a)(t,2),e=n[0],c=n[1],r=function(t){return Object(b.pipe)(c.update((function(n){var e=Object(d.a)(n,1)[0];return[t(e)]})),p.a.chain((function(t){var n=Object(d.a)(t,1)[0];return e.offer(n)})))};return Object(b.pipe)(Object(I.subject)(p.f.fromSource(p.c.pure(Object(b.pipe)(e.take,p.a.map(O.some))))),p.a.map((function(t){return Object(l.a)({},t,{next:r})})))}))),K=Object(b.pipe)(_,p.a.chain((function(t){return p.a.sync((function(){return t.innerHTML='<li>\n    <div class="view">\n        <input data-toggle class="toggle" type="checkbox">\n        <label data-edit>Buy a unicorn</label>\n        <button data-remove class="destroy"></button>\n    </div>\n    <input class="edit" value="Rule the web">\n</li>',S("li")(t)}))})),p.a.chain(p.a.fromOption(Object(m.constant)(F("Unable to create DOM element for todo item."))))),X=q(".todo-list"),Y=Object(b.pipe)(X,p.a.chain((function(t){return p.a.sync((function(){t.innerHTML=""}))}))),tt=function(t){return p.a.zip(Object(b.pipe)(t,j.map((function(t){return Object(b.pipe)(K,p.a.chain(function(t){return function(n){return Object(b.pipe)(Object(v.Do)(O.option).bind("label",S("label")(n)).bind("checkbox",S("input")(n)).bind("input",S("input.edit")(n)).return((function(e){var c=e.label,r=e.checkbox,a=e.input;return p.a.sync((function(){return c.innerHTML=t.title,n.setAttribute("data-todo-id",""+t.id),t.completed&&n.classList.add("completed"),r.checked=t.completed,a.value=t.title,n}))})),p.a.fromOption(Object(m.constant)(Error(""))),p.a.chain(m.identity))}}(t)))})),j.array.sequence(p.a.effect),p.a.chain((function(t){return Object(b.pipe)(q(".todo-list"),p.a.chain((function(n){return p.a.sync((function(){return t.forEach((function(t){return n.appendChild(t)})),n}))})))}))))(Y)},nt=Object(b.pipe)(Object(b.pipe)(G,p.a.chain((function(t){return p.a.parZip(function(t){return Object(b.pipe)(Z,p.a.chain(Object(m.flow)(m.constant,t.next)),p.a.fork,p.a.chain(Object(m.constant)(Object(b.pipe)(t.subscribe,p.a.chain((function(t){return Object(b.pipe)(t,p.f.map((function(t){return Object(b.pipe)(t,j.takeLeft(10))})),p.f.chain(Object(m.flow)(tt,p.f.encaseEffect)),p.f.drain)}))))))}(t),function(t){return Object(b.pipe)(X,p.f.encaseEffect,p.f.chain(Object(b.pipe)(x("click"))),p.f.map((function(t){return t.target})),p.f.map(O.fromNullable),p.f.chain(p.f.fromOption),p.f.chain((function(n){var e=n,c=Object(b.pipe)(D(e),O.chain((function(t){return D(t)})),p.a.pure,p.a.chain(p.a.fromOption(Object(m.constant)(C(e)))),p.a.map((function(t){return Object(b.pipe)(t.getAttribute("data-todo-id"),O.fromNullable,O.map(Number),O.map((function(n){return Object(m.tuple)(n,t)})))})),p.a.chain(p.a.fromOption(Object(m.constant)(C(e)))));return e.hasAttribute("data-remove")?Object(b.pipe)(c,p.a.chain((function(n){var e=Object(d.a)(n,1)[0];return t.next((function(t){return t.filter((function(t){return t.id!==e}))}))})),p.f.encaseEffect):e.hasAttribute("data-toggle")?Object(b.pipe)(c,p.a.chain((function(n){var e=Object(d.a)(n,1)[0];return t.next((function(t){return t.map((function(t){return t.id===e?Object(l.a)({},t,{completed:!t.completed}):t}))}))})),p.f.encaseEffect):e.hasAttribute("data-edit")?Object(b.pipe)(c,p.a.chain((function(n){var e=Object(d.a)(n,2),c=e[0],r=e[1],a=p.a.sync((function(){r.classList.add("editing")})),i=p.a.sync((function(){r.classList.remove("editing")})),o=Object(b.pipe)(r,S("input.edit"),p.a.fromOption(Object(m.constant)(F("li>input"))),p.a.chain((function(n){var e=p.a.sync((function(){n.focus(),n.select()})),r=Object(b.pipe)(n,x("blur"),p.f.take(1),p.f.drain,p.a.zip(i)),a=Object(b.pipe)(n,x("keyup"),p.f.filter((function(t){return"Enter"===t.key&&!!n.value.trim()})),p.f.take(1),p.f.drain,p.a.chain(Object(m.constant)(t.next((function(t){return t.map((function(t){return t.id===c?Object(l.a)({},t,{title:n.value}):t}))})))),p.a.zip(i));return Object(b.pipe)(e,p.a.zip(p.a.race(r,a)))})));return Object(b.pipe)(a,p.a.zip(o))})),p.f.encaseEffect):p.f.encaseEffect(p.a.pure(Object(m.constVoid)()))})),p.f.drain)}(t))})))),et=Object(b.pipe)(nt,P,N,R,s.b,p.a.provide((f=document,Object(k.a)({},L,{fromEvent:function(t){return function(n){return f.addEventListener(t,(function(t){return t.stopPropagation(),n(t)})),p.a.sync((function(){return f.removeEventListener(t,n)}))}},addEventListener:function(t){return function(n){return function(e){return t.addEventListener(n,(function(t){return t.stopPropagation(),e(t)})),p.a.sync((function(){return t.removeEventListener(n,e)}))}}}}))));p.a.runToPromise(et).then((function(t){return console.log("Done",t)})).catch((function(t){console.error(t)})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[110,1,2]]]);
//# sourceMappingURL=main.530336de.chunk.js.map